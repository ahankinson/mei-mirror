<?xml version="1.0" encoding="UTF-8"?>
<!-- 
  © 2012 by the Music Encoding Initiative (MEI) Council.
  Licensed under the Educational Community License, Version 2.0 (the "License"); you may
  not use this file except in compliance with the License. You may obtain a copy of the License
  at http://www.osedu.org/licenses/ECL-2.0.
  
  Unless required by applicable law or agreed to in writing, software distributed under the
  License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS
  OF ANY KIND, either express or implied. See the License for the specific language
  governing permissions and limitations under the License.
  
  This is a derivative work based on earlier versions of the schema © 2001-2006 Perry Roland
  and the Rector and Visitors of the University of Virginia; licensed under the Educational
  Community License version 1.0.
  
  CONTACT: info@music-encoding.org
-->

<div xmlns="http://www.tei-c.org/ns/1.0" type="div1" xml:id="cmn" n="0">
  <head>Common Music Notation</head>
  <div type="div2" xml:id="cmnOverview">
    <head>Overview of the CMN Module</head>
    <p>The module described in this chapter offers the means to describe music in so-called
        <soCalled>Common Music Notation</soCalled> (<term>CMN</term>, sometimes referred to as
        <soCalled>Common Western Music Notation</soCalled>). For this purpose, it provides a number
      of special elements and adds several attribute classes to elements from the <ref
        target="#shared">Shared</ref> module.</p>
  </div>
  <div type="div2" xml:id="cmnBasics">
    <head>Basic Elements of CMN</head>
    <p>This section describes the use of basic features of MEI important for encoding CMN material.
      Most of the elements discussed here are defined in chapter <ptr target="#shared"/> of these
      Guidelines, but are used in music from the CMN repertoire in specialized ways.</p>

    <div type="div3" xml:id="cmnMeasures">
      <head>The Role of the Measure Element</head>
      <p>Arguably, the most important element of the CMN module is the <gi>measure</gi> element. It
        is used as a structural unit inside <gi>section</gi> elements and acts as a container for
          <soCalled>events</soCalled> from the <ident type="class">model.eventLike</ident> class,
        such as notes, chords and rests as well as <soCalled>control events</soCalled> from the
          <ident type="class">model.controleventLike</ident> class, such as slurs and indications of
        dynamics.</p>
      <p>The following example demonstrates the use of the <gi>measure</gi> element:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <section>
          <measure n="1">
            <staff n="1">
              <layer>
                <chord dur="1">
                  <note pname="c" oct="5"/>
                  <note pname="g" oct="4"/>
                  <note pname="e" oct="4"/>
                </chord>
              </layer>
            </staff>
            <staff n="2">
              <layer>
                <note pname="c" oct="3" dur="1"/>
              </layer>
            </staff>
          </measure>
        </section>
      </egXML>

      <p>A <gi>measure</gi> slices the flow of a score or part into chunks that normally comply with
        a duration determined by the meter defined within a preceding <gi>scoreDef</gi> or
          <gi>staffDef</gi> element. Each staff in the source material is represented by a
          <gi>staff</gi> element. As the order of the staff elements in the file does not have to
        reflect their order in the original document, to eliminate confusion they should always
        refer to a <gi>staffDef</gi> element, using either an <att>n</att> or <att>def</att>
        attribute. Whereas the <att>def</att> attribute uses the <term>xs:anyURI</term> datatype,
        the <att>n</att> refers to the closest preceding <gi>staffDef</gi> or <gi>layerDef</gi> with
        the same value in its <att>n</att> attribute.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <staffDef xml:id="cmn_staffDef1" n="3"/>
        <!-- later in the file: -->
        <staff def="#cmn_staffDef1"><!-- @def refers to staffDef with this identifier -->
          <!-- staff content -->
        </staff>
        <!-- or: -->
        <staff n="3"><!-- @n refers to staffDef with this label -->
          <!-- staff content -->
        </staff>
      </egXML>

      <p>Each <gi>staff</gi> may hold a number of <gi>layer</gi> elements to reflect multiple
          <soCalled>voices</soCalled>. Just as with <gi>staff</gi>, the order of the <gi>layer</gi>
        elements in the file does not have to reflect their original order in the document, so they
        also possess <att>n</att> and <att>def</att> attributes for association with the appropriate
        layer definition.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <staffDef xml:id="cmn_staffDef1" n="3">
          <layerDef xml:id="cmn_layerDef1" n="1"/>
        </staffDef>
        <!-- later in the file: -->
        <staff def="#cmn_staffDef1">
          <layer def="#cmn_layerDef1">
            <!-- layer content -->
          </layer>
        </staff>
        <!-- OR: -->
        <staff n="3">
          <layer n="1">
            <!-- layer content -->
          </layer>
        </staff>
      </egXML>
    </div>

    <div type="div3" xml:id="cmnDefs">
      <head>Defining Score Parameters for CMN</head>
      <p>When encoding a score in CMN, MEI relies on the following elements from the <ref
          target="#shared">Shared</ref> module:</p>
      <p>
        <specList>
          <specDesc key="scoreDef"/>
          <specDesc key="staffGrp"/>
          <specDesc key="staffDef"/>
          <specDesc key="layerDef"/>
        </specList>
      </p>
      <p>A <gi>scoreDef</gi> element is used to specify the common parameters of a score, e.g., key
        and meter. The most important attributes for this purpose are:</p>
      <p>
        <specList>
          <specDesc key="att.meterSigDefault.log" atts="meter.count meter.unit"/>
          <specDesc key="att.meterSigDefault.vis" atts="meter.sym"/>
          <specDesc key="att.keySigDefault.log" atts="key.pname key.accid key.mode key.sig"/>
        </specList>
      </p>
      <p>The following example describes a score in common time with 3 flats:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <scoreDef meter.count="4" meter.unit="4" meter.sym="common" key.sig="3f"/>
      </egXML>

      <p>Other attributes allow the description of standard page and system margins as well as fonts
        for text and music:</p>
      <p>
        <specList>
          <specDesc key="scoreDef"
            atts="page.width page.height page.leftmar page.topmar
            page.rightmar page.bottommar system.leftmar system.topmar system.rightmar
            text.name text.fam text.size music.name music.size lyric.name lyric.fam
            lyric.size"
          />
        </specList>
      </p>
      <p>There are other attributes that allow the specification of many further details of a score.
        These are available from the element definitions accessible at <gi>scoreDef</gi>,
          <gi>staffDef</gi>, <gi>staffGrp</gi> and <gi>layerDef</gi>.</p>

      <p>When content is provided for <gi>scoreDef</gi>, it must contain a <gi>staffGrp</gi>
        element. This element is used to group individual staves and other staff groups. This is
        useful for collecting instrumental or vocal groups in a large score, such as woodwinds,
        brasses, etc., and for assigning a shared label to the group, using the <att>label</att> and
          <att>label.abbr</att> attributes. The <gi>staffGrp</gi> element is also used for the two
        staves of a grand staff. The <att>barthru</att> attribute on <gi>staffGrp</gi> allows one to
        specify whether barlines are drawn across the space between staves of that group or only on
        the staves themselves.</p>
      <p>A <gi>staffDef</gi> element is used to describe an individual staff of a <gi>score</gi> or
        performer <gi>part</gi>. It bears most of the attributes described above, including
          <att>label</att> and <att>label.abbr</att> for providing staff labels for the first and
        subsequent pages.</p>
      <p>Every <gi>staffDef</gi> must have an <att>n</att> attribute with an integer as its value.
        The first occurence of a <gi>staffDef</gi> with a given number must also indicate the number
        of staff lines via the <att>lines</att> attribute.</p>
      <p>The order of <gi>staffDef</gi> elements within <gi>scoreDef</gi> follows the order of
        staves in the source document or planned rendering. The individual <gi>staff</gi> elements
        within a <gi>measure</gi> refer back to these <gi>staffDef</gi> declarations using their own
          <att>n</att> attribute values. Therefore, the encoding order of staves within a measure
        does not have to mimic the order of the <gi>staffDef</gi> elements with
        <gi>scoreDef</gi>.</p>
      <p>Every <gi>staffDef</gi> may contain a number of <gi>layerDef</gi> elements, which describe
        distinct layers sharing one staff. MEI does not use the <term>voice</term> to describe these
          <soCalled>threads</soCalled> because that term implies continuity across measure
        boundaries. That is, while it is often the case, what is labelled as layer 1 in a given
        measure may not necessarily be labelled as layer 1 in the next measure. Therefore, MEI uses
        the more neutral term <soCalled>layer</soCalled>.</p>
      <!-- TODO: Address voice-leading here -->
      <p>In addition to the parameters inherited from <gi>scoreDef</gi>, the following attributes
        are important for <gi>staffDef</gi> elements:</p>

      <p>
        <specList>
          <specDesc key="staffDef" atts="clef.line clef.shape clef.dis clef.dis.place"/>
        </specList>
      </p>

      <p>A staff with a tenor clef is encoded as in the following example:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <staffDef clef.shape="G" clef.line="2" clef.dis="8" clef.dis.place="below"/>
      </egXML>

      <p>In the case of transposing instruments, the key-related attributes described above may be
        used to override the written key expressed in the <gi>scoreDef</gi> element. As a basic
        principle, MEI always captures written pitches, so the <att>trans.diat</att> and
          <att>trans.semi</att> attributes may be used to indicate the number of diatonic steps and
        semitones to calculate sounded pitch from written pitch. The piccolo and E♭ clarinet staves
        in the example below utilize these attributes:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <scoreDef meter.count="6" meter.unit="8">
          <!-- Piccolo sounds 12 semitones higher than written (and encoded in MEI). -->
          <staffDef n="1" xml:id="cmn.P1" label="Piccolo" label.abbr="Picc." lines="5" clef.line="2"
            clef.shape="G" key.sig="4f" key.mode="major" trans.semi="12" trans.diat="0"/>
          <staffDef n="2" xml:id="cmn.P2" label="Flute" label.abbr="Fl." lines="5" clef.line="2"
            clef.shape="G" key.sig="4f" key.mode="major"/>
          <staffDef n="3" xml:id="cmn.P3" label="Oboe" label.abbr="Ob." lines="5" clef.line="2"
            clef.shape="G" key.sig="4f" key.mode="major"/>
          <staffDef n="4" xml:id="cmn.P4" label="Bassoon" label.abbr="Bsn." lines="5" clef.line="4"
            clef.shape="F" key.sig="4f" key.mode="major"/>
          <!-- Clarinet sounds a minor third (two diatonic steps or three semitones) higher than written.  -->
          <staffDef n="5" xml:id="cmn.P5" label="Clarinet in E♭" label.abbr="E♭ Cl." lines="5"
            clef.line="2" clef.shape="G" key.sig="1f" key.mode="major" trans.semi="3" trans.diat="2"
          />
        </scoreDef>
      </egXML>

      <p>There are a number of additional elements that can be used as children of <gi>staffDef</gi>
        in order to describe additional features of the staff, such as the color of a clef or a key
        signature added in a different hand. These elements include:</p>
      <p>
        <specList>
          <specDesc key="clef"/>
          <specDesc key="clefGrp"/>
          <specDesc key="keySig"/>
          <specDesc key="keyAccid"/>
          <specDesc key="label"/>
          <specDesc key="meterSig"/>
        </specList>
      </p>

      <p>With the exception of <gi>label</gi>, these elements may also occur within the flow of
        musical events captured in a <gi>layer</gi>, since they are members of <ident type="class"
          >model.eventLike</ident>. Here, they function as milestones and affect all content
        following in that particular layer (which includes subsequent measures) until their
        information is again overridden either by the same element bearing different information or
        a <gi>staffDef</gi> or <gi>scoreDef</gi>. In this context, it is also possible to combine
        them with the elements described in chapters <ptr target="#critApp"/> and <ptr
          target="#editTrans"/> of these Guidelines.</p>
      <p>Such flexibility as this may require close inspection of an encoding to retrieve the
        correct definitions for a given staff. As a general rule, the closest preceding and most
        specific element provides this information: For example, a <gi>keySig</gi> in the preceding
        measure is more relevant than a <gi>staffDef</gi> at the beginning of the section, which is
        more relevant than a <gi>scoreDef</gi> at the beginning of the score. However, a
        section-specific <gi>scoreDef</gi> that provides only information about the meter does not
        override the more specific information about key signature gathered from a <gi>staffDef</gi>
        for a transposing instrument.</p>
    </div>
    <div type="div3" xml:id="cmnReDef">
      <!-- scoreDef and staffDef within score, section, etc. -->
      <head>Re-definition of Score Parameters</head>
      <p>Sometimes it is necessary to provide the parameters of a score or a staff with new values.
        For example. a score may change keys, gain or lose staves, use different layout settings at
        any point, etc. Likewise, a staff may change its clef, gain or lose layers, or become
        invisible, and so on. To accommodate these changes, <gi>scoreDef</gi> and <gi>staffDef</gi>
        are allowed to occur in the following places:</p>
      <list type="bulleted">
        <item/>
        <item/>
        <item/>
      </list>

    </div>
    <div type="div3" xml:id="cmnNotesChords">
      <head>Notes, Chords and Rests in CMN</head>
      <div type="div4" xml:id="cmnNotes">
        <head>Notes</head>
        <p>Undoubtedly, the most important element for encoding music notation is the <gi>note</gi>
          element, which is defined in section <ptr target="#basicEvents"/>. This section describes
          the usage of <gi>note</gi> in the CMN repertoire as well as CMN-specific additions to the
          definition in the shared module.</p>
        <div type="div5" xml:id="cmnNotesBasic">
          <head>Basic Usage of Notes in CMN</head>
          <p>In CMN, notes are determined by three basic parameters:</p>
          <list type="bulleted">
            <item>pitch name (using <att>pname</att>)</item>
            <item>octave (using <att>oct</att>)</item>
            <item>duration (using <att>dur</att>)</item>
          </list>
          <p>A typical note, in this case a quarter note C4, is therefore encoded like so:</p>
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <note pname="c" oct="4" dur="4"/>
          </egXML>
          <p> Because these attributes may not be required in all situations (such as <att>dur</att>
            for the notes of a chord), processing software should anticipate retrieving the
            information that would have been provided by missing attributes from a preceding note or
              <gi>chord</gi> parent in the same <gi>layer</gi>. Only information from
              <att>pname</att>, <att>oct</att> and <att>dur</att> attributes can be gathered in this
            fashion. No other attributes can be treated this way.</p>

          <p>The usual CMN-specific values for <att>dur</att> are:</p>
          <list type="gloss">
            <label>1</label>
            <item>whole note</item>
            <label>2</label>
            <item>half note</item>
            <label>4</label>
            <item>quarter note</item>
            <label>8</label>
            <item>eighth note</item>
            <label>16</label>
            <item>sixteenth note</item>
            <label>…</label>
            <item>…</item>
            <label>2048</label>
            <item>2048th note</item>
          </list>
          <p>Additionally, the following two values borrowed from mensural notation are allowed, as
            they sometimes also appear in CMN:</p>
          <list type="gloss">
            <label>breve</label>
            <item>double whole</item>
            <label>longa</label>
            <item>quadruple whole</item>
          </list>
          <p>Please note that their mensural counterparts bear different names in order to clearly
            distinguish between repertoires.</p>
          <p>Dotted durational values are accommodated by the <att>dots</att> attribute, which
            records the number of written augmentation dots:</p>
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <note pname="c" oct="4" dur="4" dots="1"/>
          </egXML>
        </div>
        <div type="div5" xml:id="cmnNotesGrace">
          <head>Grace Notes</head>
          <p>The CMN module adds two optional attributes, <att>grace</att> and
            <att>grace.time</att>, to <gi>note</gi> and <gi>chord</gi>. The presence of the
              <att>grace</att> attribute indicates a grace note.</p>
          <figure>
            <graphic url="../../samples/snippets/mei2012-30shortexamples/beam-grace/grace-300.png"
              width="500px"/>
          </figure>
          <p>The encoding of the left-most example would look like this:</p>
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <beam>
              <note pname="d" oct="5" dur="8" stem.dir="down"/>
              <note pname="e" oct="5" dur="8" grace="acc" stem.dir="up"/>
              <note pname="d" oct="5" dur="8" stem.dir="down"/>
              <note pname="c" accid="s" oct="5" dur="8" grace="acc" stem.dir="up"/>
              <note pname="d" oct="5" dur="8" stem.dir="down"/>
              <note pname="b" oct="4" dur="8" stem.dir="down"/>
            </beam>
          </egXML>

          <p>The values of <att>grace</att> indicate from which note time is
              <soCalled>borrowed</soCalled> to perform the grace note: The preceding note, in which
            case the value 'unacc' (unaccented) is used, or the following note, when the value 'acc'
            (accented) is appropriate. Technically this value determines if the note following the
            grace will keep its original onset timestamp or will be slightly delayed to allow the
            grace note itself to be accented. Sometimes it is not clear how to perform a grace; in
            these situations the value 'unknown' allows one to indicate a grace note without saying
            anything about its performance.</p>
          <p>The <att>grace.time</att> attribute is only to be used in combination with the
              <att>grace</att> attribute. It records the amount of time (as a percentage of the
            written duration) that the grace note should <soCalled>steal</soCalled> from the
            preceding note (when <att>grace</att>='unacc') or the following note (when
              <att>grace</att>='acc').</p>
          <p>More information about grace notes in the context of other CMN ornaments is available
            in chapter <ptr target="#cmnOrnaments"/>.</p>
        </div>
        <div type="div5" xml:id="cmnNotesStems">
          <head>Stem Modifications</head>
          <p>The CMN module also makes the <ident type="class">att.stemmed.cmn</ident> attribute
            class available, which adds the optional <att>stem.mod</att> and <att>stem.with</att>
            attributes to <gi>note</gi> and <gi>chord</gi>.</p>
          <p>The <att>stem.mod</att> attribute accommodates various stem modifiers. These symbols
            are placed on a note or chord's stem and generally indicate different types of tremolo
            and Sprechstimme. The following values are allowed:</p>
          <list>
            <label>1slash</label>
            <item>1 slash through stem</item>
            <label>2slash</label>
            <item>2 slashes through stem</item>
            <label>3slash</label>
            <item>3 slashes through stem</item>
            <label>4slash</label>
            <item>4 slashes through stem</item>
            <label>5slash</label>
            <item>5 slashes through stem</item>
            <label>6slash</label>
            <item>6 slashes through stem</item>
            <label>sprech</label>
            <item>X placed on stem</item>
            <label>z</label>
            <item>Z placed on stem</item>
          </list>
          <p>The <att>stem.mod</att> attibute is normally used in the context of <ptr
              target="#cmnTrem"/>.</p>
          <!-- TODO:
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <!-\- NEED EXAMPLE HERE! -\->
          </egXML>-->

          <p>The attribute <att>stem.with</att> allows for the indication of a stem that joins notes
            on adjacent staves.</p>
          <figure>
            <head>Cross-staff chord</head>
            <graphic url="../../samples/snippets/mei2012-30shortexamples/layer-xchord/xchord-300.png"
              width="500px"/>
          </figure>
          <p>The following code snippet demonstrates the encoding of the first chord in the last
            measure in the image above.</p>
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <staff n="1">
              <layer n="1">
                <note pname="d" oct="4" dur="2" stem.with="below"/>
              </layer>
            </staff>
            <staff n="2">
              <layer n="1">
                <chord dur="2" stem.with="above">
                  <note pname="b" oct="3" accid="n"/>
                  <note pname="f" oct="3"/>
                </chord>
              </layer>
            </staff>
          </egXML>
          <p>Alternatively, the encoder might choose to treat the notes in the second staff as
            belonging to the first one and to <soCalled>displace</soCalled> them using the
              <att>staff</att> attribute. However, this requires filling the time that they would
            normally occupy in the lower staff using the <gi>space</gi> element described in section
              <ptr target="#noteSpacing"/>. Using this mechanism, the example above could be encoded
            like so:</p>
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <staff n="1">
              <layer n="1">
                <chord dur="2">
                  <note pname="d" oct="4"/>
                  <note pname="b" oct="3" staff="2" accid="n"/>
                  <note pname="f" oct="3" staff="2"/>
                </chord>
              </layer>
            </staff>
            <staff n="2">
              <layer n="1">
                <space dur="2"/>
                <!-- following content -->
              </layer>
            </staff>
          </egXML>
        </div>
      </div>
      <div type="div4" xml:id="cmnRests">
        <head>Rests</head>
        <p>The <att>dur</att> attribute on <gi>rest</gi> allows the same values as on <gi>note</gi>
          and <gi>chord</gi>. Furthermore, the CMN module makes three more elements available for
          special forms of rest:</p>
        <p>
          <specList>
            <specDesc key="mRest"/>
            <specDesc key="multiRest"/>
            <specDesc key="mSpace"/>
          </specList>
        </p>
        <div type="div5" xml:id="cmnRestsMRest">
          <head>Measure Rests</head>
          <p>The <gi>mRest</gi> (<expan>measure rest</expan>) element is used to indicate a complete
            measure rest, independent from the meter of the current <gi>measure</gi>.</p>
          <p>The <att>cutout</att> attribute provides for the description of the rendition of the
              <gi>mRest</gi>. If <att>cutout</att> is set to <soCalled>cutout</soCalled> (the only
            value allowed), then the complete staff including the staff lines will not be rendered
            for this measure.</p>
          <figure>
            <head>Measure rest</head>
            <!-- TODO: Add image here -->
          </figure>
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <staff>
              <layer>
                <mRest xml:id="cmn.d1e437" cutout="cutout"/>
              </layer>
            </staff>
          </egXML>

          <p>It is a semantic error to mix an <gi>mRest</gi> with other events in the same
              <gi>layer</gi>. However, other <soCalled>control events</soCalled>, such as
              <gi>fermata</gi>, may be used at the same time as <gi>mRest</gi>.</p>
          <!-- TODO: use schematron to enforce this? -->
        </div>
        <div type="div5" xml:id="cmnRestsMultiRest">
          <head>Multiple-Measure Rests</head>
          <p>The <gi>multiRest</gi> (<expan>multiple measure rest</expan>) element is used to encode
            multiple measures of rest. It is commonly used in performer parts, but due to the
            problem of synchronicity with other staves, it is never found in scores. A numeric
            value, stored in the <att>num</att> attribute, indicates the number of resting measures.
            The various visual forms displayed below are not captured by <gi>multiRest</gi>, but may
            be created by rendering software.</p>
          <figure>
            <head>Forms of multiple measure rests</head>
            <graphic url="Images/modules/cmn/multirest.png" width="500px"/>
          </figure>
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <staff>
              <layer>
                <multiRest num="9"/>
              </layer>
            </staff>
          </egXML>
        </div>
        <div type="div5" xml:id="cmnRestsMSpace">
          <head>Empty Measures</head>
          <p>The <gi>mSpace</gi> (<expan>measure space</expan>) element is closely related to the
              <gi>space</gi> and <gi>mRest</gi> elements. It is used to explicitly indicate that a
            layer has no content and that no information is missing from the encoding.</p>
          <figure>
            <head>Empty measure</head>
            <graphic url="Images/modules/cmn/mspace.png" width="500px"/>
          </figure>
          <egXML xmlns="http://www.tei-c.org/ns/Examples">
            <staff>
              <layer>
                <mSpace/>
              </layer>
            </staff>
          </egXML>

        </div>
      </div>
    </div>
    <div type="div3" xml:id="cmnTstamp">
      <head>Timestamps and Durations</head>
      <p>MEI offers multiple ways of defining onsets and offsets of timed musical events like notes
        and slurs. The most common and most musician-friendly approach to this is through the use of
        a combination of the attributes <att>tstamp</att> and <att>dur</att>, which are made
        available by the attribute classes <ident type="class">att.timestamp.musical</ident>
        (inherited by <ident type="class">att.controlevent</ident>) and <ident type="class"
          >att.duration.musical</ident>, both from the shared module.</p>
      <p>The <term>timestamp</term> (<att>tstamp</att>) of a musical event is calculated in relation
        to the meter of the current measure and resembles the so-called <soCalled>beat</soCalled>.
        In a common time measure with four quarter notes, the timestamp of each quarter equals its
        beat position in the measure: The first quarter has a timestamp of 1, the second has a
        timestamp of 2, and so on. MEI defines the value of <att>tstamp</att> as a real number; the
        second eighth note position in a measure would thus be represented by the value of "1.5".
        The range of possible values is defined as starting with zero and ending with the number of
        metrical units in a measure (the <soCalled>numerator</soCalled> in a time signature) + 1.
        This allows the capture of all graphical positions starting from the left barline ('0') and
        ending with the right barline of the measure ('5', in the case of 4/4 time).</p>
      <p>For expressing durations, MEI offers two separate attributes which permit distinctly
        different values, however both named <att>dur</att>. The first model for <att>dur</att>
        attributes indicates the duration of events in the <ident type="class"
          >model.eventLike</ident> class, such as <gi>note</gi>, <gi>chord</gi> or <gi>rest</gi>.
        This attribute is described in section <ptr target="#cmnNotesBasic"/>. For
          <soCalled>spanning</soCalled> elements like slurs, which are members of the <ident
          type="class">model.controleventLike</ident> class, different <att>dur</att> values are
        provided. Its datatype is constrained to values following the formula "<hi rend="bold"><hi
            rend="italic">x</hi>m+<hi rend="italic">y</hi></hi>", where <hi rend="italic">x</hi> is
        the number of full measures that this particular feature lasts (or the number of bar lines
        crossed) and <hi rend="italic">y</hi> is the timestamp in the target measure where the
        feature ends. The timestamp is expressed using the same logic as described above. For
        example, a value of "0m+3" in 4/4 time indicates that the element bearing this attribute, a
        slur for example, ends on beat 3 of the same measure where it started. A value of "1m+1.5"
        would indicate an end on the second eighth note of the following measure. In 6/8 time, the
        value "2m+3" means that the feature ends two measures later on the third eighth note.</p>
    </div>
    <div type="div3" xml:id="cmnIMT1to6datatype">
      <head>Spanning Features in Single-pass Encodings</head>
      <p><!-- TODO: Cover imt[1-6] datatype here in a generic fashion -->
        <!-- This datatype must be restricted to a single staff. -->
      </p>
    </div>
  </div>
  <div type="div2" xml:id="additionalMeasureContent">
    <head>Advanced CMN Features</head>
    <p>Over time, many other symbols have been added to CMN beside the basic features of note,
      chord, and rest. The following section describes these symbols and introduces their handling
      in MEI.</p>

    <div type="div3" xml:id="cmnBeams">
      <head>Beams</head>
      <p>A very common feature of music from the CMN repertoire is the beaming of eighth or shorter
        notes. MEI provides two elements for the explicit encoding of features joined by beams.</p>
      <p>
        <specList>
          <specDesc key="beam"/>
          <specDesc key="beamSpan"/>
        </specList>
      </p>

      <p>Use of the <gi>beam</gi> element is straightforward. The beamed notes, rests, or chords are
        simply enclosed by the <gi>beam</gi> element:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <layer>
          <beam>
            <note dur="8"/>
            <note dur="8"/>
          </beam>
        </layer>
      </egXML>

      <p>Whereas in music notation every note value shorter than an eighth adds another beam
        (sometimes referred to as <soCalled>secondary beams</soCalled>), in MEI only one beam
        element is used, no matter what the durations of the contained notes are:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <layer> … <beam>
            <note dur="16"/>
            <note dur="32"/>
            <note dur="32"/>
            <note dur="16" dots="1"/>
            <note dur="32"/>
          </beam> … </layer>
      </egXML>

      <p>From the 19th century onwards, it became quite common to break secondary beams to increase
        readability of longer beamed passages. It is possible to encode situations like this in MEI
        without nesting beam elements. Instead, the optional <att>breaksec</att> attribute on
          <gi>note</gi>s and <gi>chord</gi>s under the beam may be used to encode the breaking of
        secondary beams <emph>after</emph> the note or chord bearing the attribute. The value of
          <att>breaksec</att> indicates the number of continuous beams. For example:</p>
      <!-- TODO: Include image -->
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <layer> … <beam>
            <note dur="16"/>
            <note dur="16"/>
            <note dur="16"/>
            <note dur="16" breaksec="1"/>
            <note dur="32"/>
            <note dur="32"/>
            <note dur="32"/>
            <note dur="32" breaksec="2"/>
            <note dur="32"/>
            <note dur="32"/>
            <note dur="32"/>
            <note dur="32"/>
          </beam> … </layer>
      </egXML>

      <p>In the music of the second half of the 20th century, it is quite common to indicate
        acceleration or deceleration using converging beams as in the image below:</p>

      <p>The encoding of such a beam is accomplished using the <att>rend</att> attribute of the
        beam, which allows the following values:</p>
      <list type="gloss">
        <label>acc</label>
        <item>The secondary beams start in their usual position and gradually converge until they
          meet with the primary beam on the last note (or, the first eighth note under the beam). </item>
        <label>rit</label>
        <item>The secondary beams gradually diverge until they reach their regular distance. </item>
        <label>mixed</label>
        <item>The secondary beams diverge and converge arbitrarily.</item>
        <label>norm</label>
        <item>The beam is rendered as usual (default). </item>
      </list>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <layer>
          <!-- … -->
          <beam rend="acc">
            <note dur="8"/>
            <note/>
            <note/>
            <note/>
            <note/>
            <note dur="32"/>
          </beam>
          <!-- … -->
        </layer>
      </egXML>
      <p>The duration of notes, rests, or chords under a beam which carries the <att>rend</att>
        attribute with a value of 'acc', 'rit', or 'mixed' must be treated specially. The first and
        last contained elements must specify a duration which matches the number of beams displayed
        at the point of these events. In the case of a 'mixed' beam, each event at the point of
        change in the number of secondary beams must carry a <att>dur</att> attribute. Beams like
        this may be encoded thusly:</p>
      <figure>
        <graphic url="Images/modules/cmn/beamAcc-Rit.png" width="500px"/>
      </figure>
      <p>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <layer>
            <!-- … -->
            <beam rend="mixed">
              <note dur="8"/>
              <note dur="8"/>
              <note/>
              <note/>
              <note/>
              <note dur="32"/>
            </beam>
            <beam rend="mixed">
              <note dur="32"/>
              <note/>
              <note/>
              <note/>
              <note/>
              <note dur="8"/>
              <note dur="8"/>
            </beam>
            <!-- … -->
          </layer>
        </egXML>
      </p>

      <!-- TODO: Cross-staff beaming using @beam.with -->
      <figure>
        <head>Cross-staff beam</head>
        <graphic url="Images/ExampleImages/beam-c-20100510.png" height="150px"/>
      </figure>

      <p>Due to the potential problem of creating overlapping hierarchies, the <gi>beam</gi> element
        only allows the encoding of beams that do not cross barlines. When beams cross barlines, the
        use of the <gi>beamSpan</gi> element is required. Unlike <gi>beam</gi>, the
          <gi>beamSpan</gi>element does not contain the beamed notes as its children. Instead, it
        references the <att>xml:id</att> values of all affected notes in its <att>plist</att>
        attribute and denotes the initial and terminal notes of the beam using <att>startid</att>
        and <att>endid</att> attributes. This configuration allows beams to cross measures and even
        staves. The following example demonstrates a typical example of such hierarchy-crossing
        beams:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <beamSpan startid="#note1" endid="#note4" plist="#note1 #note2 #note3 #note4"/>
      </egXML>

      <!-- TODO: flesh out the following paragraph. -->
      <p>Beams may also be encoded using the <att>beam</att> attribute. This feature is useful when
        a single-pass encoding style is desired.</p>

      <p>In addition to the explicit encoding of beams accommodated by the <gi>beam</gi> and
          <gi>beamSpan</gi> elements and the <att>beam</att> attribute, MEI allows for specification
        of default beaming behavior using the following attributes on <gi>scoreDef</gi>,
          <gi>staffDef</gi>, and <gi>layerDef</gi>:</p>
      <list type="gloss">
        <label><att>beam.group</att></label>
        <item>Provides an example of how automated beaming (including secondary beams) is to be
          performed.</item>
        <label><att>beam.rests</att></label>
        <item>Indicates whether automatically-drawn beams should include rests shorter than a
          quarter note duration.</item>
      </list>

      <p>The <att>beam.group</att> attribute can be used to set a default beaming pattern to be used
        when no beaming is indicated at the layer level. It must contain a comma-separated list of
        time values that add up to a measure, e.g., '4,4,4,4' in 4/4 time indicates that each
        quarter note worth of shorter notes should be beamed together. Parentheses can be used to
        indicate sub-groupings of secondary beams. For example, '(4.,4.,4.)' in 9/8 meter indicates
        one primary beam per measure with secondary beams broken at each dotted quarter duration,
        while '(4,4),(4,4)' in 4/4 will result in a measure of 16th notes being rendered with a
        primary beam covering all the notes and secondary beams for each group of four 16th
        notes.</p>
      <p>The <att>beam.group</att> attribute is available on <gi>scoreDef</gi>, <gi>staffDef</gi>,
        and <gi>layerDef</gi> elements, making it possible to set different beaming patterns for
        each of these. Also, the beaming pattern can be changed anywhere score parameters may be
        changed, for example, at the start of sections. This beaming "directive" can be overridden
        by using <gi>beam</gi>, <gi>beamSpan</gi>, or <att>beam</att> attributes as described above.
        If none of these beaming specifications is used, then no beaming is implied. Default beaming
        can be explicitly 'turned off' by setting <att>beam.group</att> to an empty string.</p>

    </div>

    <div type="div3" xml:id="cmnSlurTies">
      <head>Ties, Slurs and Phrase Marks</head>
      <p>One of the most specific features of CMN is the use of <soCalled>curved lines</soCalled>
        which connect notes. These lines are used to indicate various musical features, depending on
        their context.</p>
      <p>A <term>tie</term> is a curved line connecting <emph>two</emph> notes of the <hi
          rend="bold">same pitch</hi>. The intention of a tie is to combine the duration of both
        notes, so that the first note sounds for the combined duration, while the second note isn't
        played separately from the first note. In other words, there is only one onset for both
        notes.</p>
      <p>In MEI, ties can be encoded in different ways, depending on the level of detail that the
        encoder wants to preserve. The simplest solution is to use the <att>tie</att> attribute
        found on <gi>note</gi> and <gi>chord</gi>.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <note pname="f" oct="4" dur="2" tie="i"/>
        <note pname="f" oct="4" dur="4" dots="1" tie="t"/>
      </egXML>

      <p>This attribute allows three values:</p>
      <list type="gloss">
        <label><emph>i</emph> (initial)</label>
        <item>Marks the start of a tie</item>
        <label><emph>m</emph> (medial)</label>
        <item>Marks a participant in a tie other than the first or last</item>
        <label><emph>t</emph> (terminal)</label>
        <item>Marks the end of a tie</item>
      </list>

      <p>The scope of the <att>tie</att> attribute is the musical <gi>layer</gi>; that is, a tie
        started in one layer may only be ended by a subsequent musical event with a <att>tie</att>
        attribute with an <emph>m</emph> or <emph>t</emph> value in the same layer. The
        tie-terminating event may lie in the following measure.</p>
      <figure>
        <head>Ties across barlines</head>
        <graphic url="../../samples/snippets/mei2012-30shortexamples/layer-xchord/tie-finger.png"/>
      </figure>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <measure n="1">
          <!-- staff 1 omitted -->
          <staff n="2">
            <layer n="1">
              <chord dur="16"/>
              <beam>
                <note pname="f" tie="i"/>
                <note pname="a" tie="i"/>
                <note pname="c" tie="i"/>
              </beam>
              <chord dur="4">
                <note pname="f" tie="i"/>
                <note pname="c" tie="m"/>
                <note pname="a" tie="m"/>
                <note pname="f" tie="m"/>
              </chord>
            </layer>
          </staff>
        </measure>
        <measure n="2">
          <!-- staff 1 omitted -->
          <staff n="2">
            <layer n="1">
              <chord dur="16">
                <note pname="f" tie="t"/>
                <note pname="c" tie="t"/>
                <note pname="a" tie="t"/>
                <note pname="f" tie="t"/>
              </chord>
              <!-- ... -->
            </layer>
          </staff>
        </measure>
        <!-- measures 3 and 4 omitted -->
      </egXML>

      <p>When <att>tie</att> is used on chords, it functions as a shorthand indication; that is, a
        separate tie is drawn for every pitch in the chord that remains unchanged in the succeeding
        chord.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <layer>
          <chord dur="4" tie="i">
            <note pname="f"/>
            <note pname="c"/>
            <note pname="a"/>
            <note pname="f"/>
          </chord>
          <chord dur="4" tie="t"/>
        </layer>
      </egXML>

      <p>A <term>slur</term> is a curved line that connects a <emph>range of notes</emph> and
        normally denotes that the affected notes are to be played <term>legato</term>. In MEI, slurs
        may be encoded in a very similar way to ties: <gi>note</gi> and <gi>chord</gi> bear a
          <att>slur</att> attribute that allows the commencement or ending of a slur at this
        element.</p>
      <p>The allowed values, however, are slightly different: The <emph>i</emph>, <hi rend="bold"
          >m</hi> or <emph>t</emph> are followed by a single digit in the range <emph>1 to 6</emph>,
        as in the following example:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <note pname="f" oct="4" dur="4" accid="s" slur="i1"/>
        <note pname="g" oct="4" dur="4" slur="m1"/>
        <note pname="a" oct="4" dur="4" slur="t1"/>
      </egXML>

      <p>The reason for this difference is that slurs, unlike ties, may overlap, so that a second
        slur may start while the first slur is still ongoing. The digit indicates the level of
        nesting of slurs on the note; '1' indicates no nesting, while '2' indicates the existence of
        2 slurs in which this note participates, and so on. In the example below, the second and
        third quarter notes lie under 2 slurs:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <layer>
          <note pname="g" oct="4" dur="2" slur="i1"/>
          <note pname="a" oct="4" dur="8" slur="i2"/>
          <note pname="g" oct="4" dur="8" slur="t2"/>
          <note pname="f" oct="4" dur="4" accid="s" slur="t1"/>
        </layer>
        <layer>
          <note pname="b" oct="3" dur="2" dots="1" slur="i1"/>
          <note pname="d" oct="4" dur="4" slur="t1"/>
        </layer>
      </egXML>

      <p>While ties are not allowed to cross layers or staves in standard notation, slurs may. The
        following example demonstrates how cross-staff slurs may be encoded using the
          <att>slur</att> attribute:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <staff>
          <layer>
            <note pname="g" oct="4" dur="2" slur="i1"/>
            <note pname="a" oct="4" dur="8" slur="m1"/>
            <note pname="g" oct="4" dur="8" slur="m1"/>
            <note pname="f" oct="4" dur="4" accid="s" slur="m1"/>
          </layer>
        </staff>
        <staff>
          <layer>
            <note pname="b" oct="3" dur="2" dots="1" slur="t1"/>
            <note pname="d" oct="4" dur="4"/>
          </layer>
        </staff>
      </egXML>

      <!--  Perhaps this should only be permitted when the analysis module is enabled. Hmmm ... -->
      <p>To support analytical operations, <att>slur</att> may take on more than one value. For
        example, the example above may be more explicitly encoded as:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <layer>
          <note pname="g" oct="4" dur="2" slur="i1"/>
          <note pname="a" oct="4" dur="8" slur="m1 i2"/>
          <note pname="g" oct="4" dur="8" slur="m1 t2"/>
          <note pname="f" oct="4" dur="4" accid="s" slur="t1"/>
        </layer>
        <layer>
          <note pname="b" oct="3" dur="2" dots="1" slur="i1"/>
          <note pname="d" oct="4" dur="4" slur="t1"/>
        </layer>
      </egXML>

      <p>Slurs and ties that cross system or page breaks are split into two separate symbols. One
        slur or tie ends at the last barline, another one starts at the begin of the new system. MEI
        expects this to be the default rendering behaviour, so that in situations like these, the
        regular <att>tie</att> or <att>slur</att> attributes are sufficient to describe both curved
        lines resulting from the split.</p>
      <p>Sometimes, however, one of these two symbols is missing in the document, or the encoder
        wants to provide additional information about the slur or tie. In these cases, using an
        attribute is not an adequate solution. Therefore, MEI offers dedicated elements:
          <gi>tie</gi> and <gi>slur</gi>. A third element, <gi>phrase</gi> is used to identify a
        unified melodic idea (in German: <foreign>Phrasierungsbogen</foreign>), whereas the
          <gi>slur</gi> element is used as a generic element for all curved lines (in German:
          <foreign>Bogensetzung</foreign>) except ties. All three elements have nearly identical
        models.</p>
      <p>Although these elements are allowed within a <gi>layer</gi> to accommodate unmeasured
        notation, by convention they are normally placed inside <gi>measure</gi>, after the encoding
        of staves, grouped with other so-called <soCalled>control events</soCalled>.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <measure>
          <staff n="1">
            <layer>
              <note pname="c" oct="5" dur="4"/>
              <note pname="f" oct="4" dur="4"/>
              <note pname="g" oct="4" dur="4"/>
              <note pname="c" oct="4" dur="4"/>
            </layer>
          </staff>
          <slur/>
        </measure>
      </egXML>

      <p>Obviously, the slur in the above example needs to be <soCalled>attached</soCalled> to the
        notes somehow. The <soCalled>vertical assignment</soCalled> can be indicated for the example
        above using the <att>staff</att> and <att>layer</att> attributes like so:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <slur staff="1" layer="1"/>
      </egXML>

      <p>For the <soCalled>horizontal assignment</soCalled>, the encoder may choose between two
        different mechanisms. The first uses timestamp and duration as described in section <ptr
          target="#cmnTstamp"/>. The start and end points of the slur may be indicated thusly:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <slur staff="1" layer="1" tstamp="1" dur="0m+4"/>
      </egXML>

      <p>By using <att>tstamp</att> and <att>dur</att>, the encoder denotes a rather loose
        connection – the slur (or tie) is attached to a certain position in the measure, not to a
        specific note or chord. If the encoder wants to specify a close connection to a particular
        event, the <att>startid</att> and <att>endid</att> attributes may be used instead. Here, the
          <att>xml:id</att>s of the first and last note of the slur are referenced. This mechanism
        also allows the crossing of layers and staves, as in the following example:</p>
      <!-- TODO:
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <!-\- TODO: Snippet from Webern, also as graphic -\->
      </egXML>-->

      <p>For human readability, it is recommended to encode <gi>slur</gi>, <gi>tie</gi> and
          <gi>phrase</gi> features that use <att>startid</att> and <att>endid</att> in the
          <gi>measure</gi> where they begin; that is, in the measure that holds the element
        referenced by <att>startid</att>. On the other hand, for machine processability, it may be
        desirable to place <gi>slur</gi>, <gi>tie</gi>, and <gi>phrase</gi> elements in the measure
          <emph>where they end</emph> or even in the <emph>last measure</emph> regardless of their
        begin and end points in the music. Doing so makes all references contained within these
        elements <soCalled>back references</soCalled>. Back references are necessary when using
        processing software that treats the encoded file as a stream; that is, programs that process
        the file without creating an in-memory representation of its contents.</p>
      <p>When using the <gi>tie</gi>, <gi>slur</gi> or <gi>phrase</gi> elements, the curvature of
        the line may be described using the <att>curvedir</att>, <att>bulge</att> and
          <att>bezier</att> attributes. Whereas the first attribute allows only specification of the
        slur's vertical placement, the others give increasingly more precise control of the
        curve.</p>
      <p>A reason for using elements instead of attributes for ties, slurs, and phrase marks is that
        only elements may be combined with the functionality provided in chapters <ptr
          target="#editTrans"/> and <ptr target="#critApp"/> of these Guidelines.</p>
      <p>If the encoder wishes to draw attention to the appearance of a slur or tie in a given
        source, the <att>facs</att> attribute may be used instead of (or in addition to) the curve
        description attributes to point to a graphic image or a zone within an image (see <ptr
          target="#facsimile"/>).</p>
    </div>

    <div type="div3" xml:id="cmnDynam">
      <head>Dynamics in CMN</head>
      <p>Common Music Notation provides two different methodologies for expressing the degree of
        loudness of a note, phrase, section, etc. The first is a verbal instruction providing such
        information in human language, possibly in an abbreviated form. An example is the word
          <term>piano</term>, meaning a quiet volume, often abbreviated as <term>p</term>. In MEI,
        verbal instructions like this are encoded using the <gi>dynam</gi> element from the Shared
        module (see chapter <ptr target="#shared"/>):</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <dynam>p</dynam>
      </egXML>

      <p>By convention, <gi>dynam</gi> elements, like <gi>slur</gi> and other elements belonging to
        the <ident type="class">model.controleventLike</ident> class, are encoded at the end of the
          <gi>measure</gi> to which they belong. This requires <gi>dynam</gi> to be assigned to a
        certain <gi>staff</gi> using the <att>staff</att> attribute, which refers to the target
        element's <att>n</att> attribute.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <dynam staff="1">p</dynam>
      </egXML>

      <p>When the layers of a staff have different dynamic indications, the <att>layer</att>
        attribute may be used to associate the dynamic marking with a particular layer:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <dynam staff="1" layer="1">p</dynam>
        <dynam staff="1" layer="2">mf</dynam>
      </egXML>

      <p>The location of a dynamic marking in relation to a staff may be specified using the
          <att>place</att> attribute, which may be given as <emph>above</emph>, <hi rend="bold"
          >within</hi> or <emph>below</emph> the staff:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <dynam staff="1" place="above">p</dynam>
      </egXML>

      <p>Dynamics must also be associated with a particular time point in a measure, using the
          <att>tstamp</att> or <att>startid</att> attributes as described in section <ptr
          target="#cmnTstamp"/>:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <measure>
          <staff n="1">
            <!-- content omitted -->
          </staff>
          <staff n="2">
            <layer n="1">
              <note pname="c" oct="4" dur="2" stem.mod="2slash"/>
              <note pname="e" oct="4" dur="2" stem.mod="2slash"/>
            </layer>
            <layer n="2">
              <!-- content omitted -->
            </layer>
          </staff>
          <dynam staff="2" layer="1" place="above" tstamp="1">p</dynam>
          <dynam staff="2" layer="1" place="above" tstamp="2.5">cresc. poco a poco</dynam>
        </measure>
      </egXML>

      <p>Dynamics which do not have an explicit endpoint are often referred to as
          <soCalled>instantaneous</soCalled>. On the other hand, some dynamic directions indicate a
        continuous change that must have a defined end point. It is possible to specify the logical
        scope of continuous dynamic marks using the attributes <att>dur</att> or <att>endid</att>.
        In order to capture the fact that they continue until the first beat of the next measure,
        the <term>crescendo</term> in the example above may be marked:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <!-- using the dur attribute -->
        <dynam staff="2" place="above" tstamp="2.5" dur="1m+1">cresc. poco a poco</dynam>
        <!-- using the endid attribute -->
        <dynam staff="2" place="above" tstamp="2.5" endid="ID of ending note">cresc. poco a
          poco</dynam>
      </egXML>

      <p>Any combination of <att>tstamp</att>, <att>startid</att>, <att>dur</att>, and
          <att>endid</att> attributes may be used to define the scope of a dynamic, although the
          <att>tstamp</att> and <att>dur</att> or the <att>startid</att> and <att>endid</att>
        combinations are the most common combinations. For example, the following alternatives are
        all possibilities for marking up a <term>crescendo</term>. The exact choice of attributes is
        often processor dependent.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <!-- tstamp attribute indicates starting point, dur attribute marks the end -->
        <dynam staff="2" place="above" tstamp="2.5" dur="1m+1">cresc. poco a poco</dynam>
        <!-- tstamp attribute indicates starting point, endid attribute marks the end -->
        <dynam staff="2" place="above" tstamp="2.5" endid="ID of last note">cresc. poco a
          poco</dynam>
        <!-- startid attribute indicates starting point, dur attribute marks the end -->
        <dynam staff="2" place="above" startid="ID of starting note" dur="1m+1">cresc. poco a
          poco</dynam>
        <!-- startid attribute indicates starting point, endid attribute marks the end -->
        <dynam staff="2" place="above" startid="ID of starting note" endid="ID of ending note"
          >cresc. poco a poco</dynam>
      </egXML>

      <p>All musical elements affected by the <gi>dynam</gi> may be explicitly specified using the
          <att>plist</att> attribute, which contains <att>xml:id</att> attribute values:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <dynam staff="2" place="above" startid="#note1" endid="#note4"
          plist="#note1 #note2 #note3
          #note4">cresc. poco a poco</dynam>
      </egXML>

      <p>Since the <att>plist</att> attribute's use is primarily analytical and the tstamp/startid
        and dur/endid attributes are often used for rendering, it is recommended that the list of
        references in <att>plist</att> include all participants in the dynamic marking, including
        the first and last notes as in the preceding example, even though they are also referenced
        by <att>startid</att> and <att>endid</att> attributes.</p>

      <p>In addition to verbal instructions, Common Music Notation uses graphical symbols to
        indicate <soCalled>continuous</soCalled> dynamics. These <term>crescendo</term> and
          <term>decrescendo</term> (or <term>diminuendo</term>) symbols are encoded in MEI using the
          <gi>hairpin</gi> element. It also is a member of the <ident type="class"
          >model.controleventLike</ident> class, which means it too is used just before the close of
        a <gi>measure</gi> element, following the encoding of all staves. The required attribute
          <att>form</att> specifies the direction of the symbol by taking one of two possible
        values: <emph>cres</emph>cendo (louder) or <emph>dim</emph>inuendo (softer).</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <hairpin form="cres"/>
      </egXML>

      <p>Positioning of hairpins is possible using the same attributes as for <gi>dynam</gi>, so the
        example above could be encoded as:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <hairpin form="cres" staff="2" layer="1" place="above" tstamp="2.5" dur="1m+1"/>
      </egXML>

      <!-- TODO: discuss the other visual attributes of hairpin:
        @opening
        <memberOf key="att.color"/>
        <memberOf key="att.visualoffset"/>
        <memberOf key="att.visualoffset2"/>
        <memberOf key="att.xy"/>
        <memberOf key="att.xy2"/> -->

    </div>
    <div type="div3" xml:id="cmnTuplets">
      <head>Tuplets</head>
      <p>Tuplets indicate a localized change of meter; that is, a given duration in the regular
        meter is divided between a group of notes with irregular (according to the current meter)
        rhythmic values. The most common tuplet is a so-called <soCalled>triplet</soCalled>, in
        which three notes take the time normally occupied by two.</p>
      <p>The relation of the tuplet to the underlying meter is specified using the <att>num</att>
        and <att>numbase</att> attributes, where <att>num</att> specifies the number of replacing
        notes and <att>numbase</att> specifies the number of notes <emph>of the same duration</emph>
        to be replaced. For example, when three eighth notes replace one quarter note in common
        time, <att>num</att> takes a value of "3", whereas <att>numbase</att> reads "2", because a
        quarter note in common time is normally divided into two eighths. When three quarters
        replace two in the same meter, <att>numbase</att> also reads "2". The combination of these
        attributes may be read as "3 (notes) in the time of 2 (notes)" in either case.</p>
      <p>The duration of the entire tuplet may be encoded using the usual <soCalled>power of
          2</soCalled> values, e.g., 1, 2, 4, etc., in the <att>dur</att> attribute.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <layer>
          <tuplet num="3" numbase="2" dur="2">
            <note pname="g" oct="4" dur="4"/>
            <note pname="f" oct="4" dur="4" accid="s"/>
            <note pname="g" oct="4" dur="4"/>
          </tuplet>
          <note pname="d" oct="4" dur="2"/>
        </layer>
      </egXML>

      <!-- TODO: Cover omission of numbase and/or dur. -->

      <p>Tuplets are often highlighted using brackets above or below the affected notes. The
        presence and position of these brackets can be encoded using the <att>bracket.place</att>
        (above / below) and <att>bracket.visible</att> (true / false) attributes.</p>
      <p>A number or ratio may be given in addition to, or in some cases as a replacement for, the
        bracket. The <att>num.format</att> attribute indicates whether a plain number (the value of
          <att>num</att>) or a ratio (comprised of <att>num</att> and <att>numbase</att>, e.g.,
        "3:2") should be displayed and <att>num.visible</att> indicates the general presence of such
        a number. Usually, however, tuplets are rendered with a bracket
        (<att>bracket.visible</att>="true") and a single number (<att>num.format</att>="count" and
          <att>num.visible</att>="true").</p>
      <!--<egXML xmlns="http://www.tei-c.org/ns/Examples">
        <!-\- NEED EXAMPLE HERE! -\->
      </egXML>-->

      <p>Beside <gi>note</gi> elements, <gi>tuplet</gi> may contain other elements, such as
          <gi>rest</gi> or <gi>space</gi>, to match the content of a source document or an intended
        rendering. In particular, the <gi>beam</gi> element is allowed so that custom beaming may be
        indicated, e.g., a septuplet may be divided into a group of three plus a group of four
        notes.<!--, as described in Read, p. 187-215.--></p>
      <!-- TODO:
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <!-\- NEED EXAMPLE HERE! -\->
      </egXML>-->

      <!--The tuplet element may also used for bowed tremolo (Read, p. 394) and double,
        triple, or flutter tonguing (Read, p. 348-349); that is, for repetition of the same pitch.
        In the case of irrational durations, such as two quarter notes in the time of five
        8th notes in a measure of 5/8 time, decimal values may be used in the dur.ges attribute. For
        example, the dur.ges attribute would take the value "2.5" if the midi.div attribute's value
        was "1". The num and numbase attributes may be used for explicit labelling of a tuplet, such
        as, '3' with an 8th-note triplet, '3:2' over a quarter-note triplet, etc. The rendering of
        the ratio, however, is dependent on the num.format attribute found in the att.vis.tuplet
        attribute class.-->


      <p>In some situations, a tuplet is made up of events from different measures or even different
        staves. As this raises the issue of non-concurrent hierarchies, it is not possible to encode
        such situations with the <gi>tuplet</gi> element described above. Therefore, MEI offers the
          <gi>tupletSpan</gi> element, which is member of the <ident type="class"
          >model.controleventLike</ident> class. It is nested inside of <gi>measure</gi>, following
        all the measure's <gi>staff</gi> children. It uses the same attributes as <gi>tuplet</gi> to
        describe tuplets, but instead of nesting all affected notes inside itself, it points to the
        notes' respective <att>xml:id</att>s using its <att>plist</att> (participant list)
        attribute.</p>
      <!-- TODO:
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <!-\- NEED EXAMPLE HERE! -\->
      </egXML>-->

    </div>

    <div type="div3" xml:id="cmnArtic">
      <head>Articulation and Performance Instructions in CMN</head>
      <p>This section introduces elements and attributes which may hold CMN-specific performance
        instructions. The functionality described herein is related to the <att>artic</att>
        attribute and <gi>artic</gi> element introduced in <ptr target="#shared"/>. The following
        elements are relevant in this context:</p>
      <p>
        <specList>
          <specDesc key="bend"/>
          <specDesc key="bTrem"/>
          <specDesc key="fTrem"/>
          <specDesc key="gliss"/>
          <specDesc key="arpeg"/>
          <specDesc key="octave"/>
          <specDesc key="fermata"/>
        </specList>
      </p>
      <div type="div4" xml:id="cmnArpegGliss">
        <head>Arpeggio and Glissando</head>
        <p>In CMN, the notes of a chord are sometimes performed successively rather than
          simultaneously. This behavior, called <term>arpeggio</term>, is normally indicated using a
          wavy line preceding the chord. MEI offers the <gi>arpeg</gi> element to describe
          arpeggios. This element is a member of the <ident type="class"
            >model.controleventLike</ident> class and, like other members of this class, uses the
            <att>staff</att>, <att>layer</att> and <att>tstamp</att> or the <att>startid</att> and
            <att>endid</att> attributes to connect it to the affected chord.</p>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <measure>
            <staff n="1">
              <!-- content omitted -->
            </staff>
            <staff n="2">
              <layer>
                <note dur="4"/>
                <note dur="4"/>
                <chord dur="4">
                  <!-- notes omitted -->
                </chord>
                <note/>
              </layer>
            </staff>
            <arpeg staff="2" tstamp="3"/>
          </measure>
        </egXML>

        <p>The usual direction for the performance of an arpeggio is from lowest note to highest,
          but this is not always the case. The customary signal of an downward arpeggio is an
          arrowhead added to the bottom of the wavy line. The indication of the presence of an
          arrowhead and the direction of the arpeggio are handled separately, however. The
            <att>arrow</att> attribute indicates the presence of an arrowhead in the arpeggiation
          sign, while the <att>order</att> attribute records the preferred sequence of notes.</p>
        <p>The following example illustrates various ways in which the arrow and order attributes
          may be employed. The default visual rendition and performance are assumed in the absence
          of both attributes, while the typical downward arpeggio is indicated by the presence of
          both attributes. The last two possibilities occur less frequently, but are sometimes
          appropriate: The presence of the arrow attribute without the order attribute may be used
          in those cases where the arrowhead is redundant but is added to the symbol for the sake of
          consistency or when the direction of successive arpeggios changes frequently. The last
          possibility, an order attribute without an arrow attribute, is ambiguous; however, it can
          be used as an encoding shortcut as a downward arpeggio must have a visual indication of
          its direction to distinguish it from the upward arpeggio; therefore, the presence of the
          arrowhead can be implied.</p>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <!-- default visualization and performance -->
          <arpeg staff="2" tstamp="3"/>
          <!-- downward arpeggio with arrow added to visual symbol -->
          <arpeg staff="2" tstamp="3" order="down" arrow="true"/>
          <!-- default rendition with (redundant) arrow added to the top of the visual symbol -->
          <arpeg staff="2" tstamp="3" arrow="true"/>
          <!-- downward arpeggio with no visual indication of order -->
          <arpeg staff="2" tstamp="3" order="down"/>
        </egXML>

        <p>A third value for <att>order</att>, "nonarp", indicates that no arpeggio shall be
          performed. Normally rendered as a bracket instead of a wavy line, this form of arpeggio is
          used to indicate a non-arpeggiated chord in a sequence of arpeggiated ones. This is common
          in music for the harp, where arpeggiation is the usual method of performing chords.</p>
        <!-- TODO:
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <!-\- NEED EXAMPLE HERE! -\->
        </egXML>-->

        <p>For arpeggios that involve chords spanning multiple staves as a continuous arpeggio
          (instead of two separate arpeggios), the <att>plist</att> attribute may be used to point
          to all affected <gi>chord</gi> elements' <att>xml:id</att>s.</p>
        <!-- TODO:
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <!-\- NEED EXAMPLE HERE! -\->
          <!-\- TODO: Example from Rachmaninoff c#min sonata -\->
        </egXML>-->

        <p>Whereas an arpeggio <soCalled>staggers</soCalled> the onset times of the notes of a
          chord, a <term>glissando</term> denotes a situation where the pitch
            <soCalled>slides</soCalled> from one note to another. It makes no difference whether
          this slide produces distinct intermediate pitches (as on the piano) or not (as on the
          trombone), though the latter is sometimes referred to as <term>portamento</term>. The
          visual appearance of a glissando, which MEI encodes as <gi>gliss</gi>, is normally a line
          connecting the two most distant notes in the glissando.</p>

        <p>The <gi>gliss</gi> element is a member of the <ident type="class"
            >model.controleventLike</ident> class and therefore it occurs inside a measure after the
          staves and uses its <att>staff</att>, <att>layer</att>, <att>tstamp</att>, <att>dur</att>,
            <att>startid</att> and <att>endid</att> attributes to connect it to the affected notes
          or chords. It is a semantic error not to specify a starting point attribute. The visual
          appearance of the indicating line may be recorded in the <att>rend</att> attribute. Any
          text accompanying the line, such as "gliss.", may be provided in the <att>text</att>
          attribute. </p>

      </div>

      <!-- TODO: PR will editi this! -->
      <!-- <div type="div4" xml:id="cmnBend">
        <head>Bend</head>
        <p>
          <gi>bend</gi>: A variation in pitch (often microtonal) upwards or downwards during the course of a note. 
          Typically, the performer attacks the note at "true" pitch, bends the intonation, then returns to true pitch. 
          The bend element can also be used for scoop, plop, falloff, and doit performance effects. It should *not* be 
          used for l.v. (laissez vibrer) indications. Precise performance data that differs from the logical events in 
          a measure may be recorded within the bend element. The starting point of the bend may be indicated by either 
          a tstamp, tstamp.ges, tstamp.real or startid attribute. It is a semantic error not to specify a starting 
          attribute. ENDING POINT DEFINTION
       </p>
      </div>-->

      <!-- TODO: PR will editi this! -->
      <div type="div4" xml:id="cmnTrem">
        <head>Tremolandi</head>
        <!-- TODO: In german terminology, a tremolo often indicates an unmeasured series of notes (play as
          fast as you can). What we call "Faulenzer" (lazy one) is measured, though. Basically, the rendition of both
          is the same, but we distinguish between measured and unmeasured, not between identical and differing
          pitches. Is this something we should discuss on MEI-L?
        -->
        <p>CMN has two slightly different concepts which are both called <term>tremolo</term>. The
          first is a rapid repetition of a single pitch or chord, whereas the second is a rapid
          alternation between two different notes or chords. In addition, either species of tremolo
          may be <term>measured</term> or <term>unmeasured</term>. A measured tremolo is an
          abbreviation for written-out notation; that is, the tremolo is intended to be perceived as
          notes with distinct rhythmic values. On the other hand, in an unmeasured tremolo no
          specific number of alternations is intended.</p>
        <p>For the repetition of a single note or chord, MEI offers the <gi>bTrem</gi> (bowed
          tremolo) element, which is a member of the <ident type="class">model.eventLike</ident>
          class, meaning it is encoded following the normal course of musical events within a
            <gi>layer</gi>. It holds exactly one <gi>note</gi> or <gi>chord</gi> element that is to
          be repeated.</p>
        <!-- TODO: provide better example with image… -->
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <layer>
            <note/>
            <bTrem>
              <note pname="g" oct="4" dur="4"/>
            </bTrem>
            <note/>
          </layer>
        </egXML>

        <p>As seen in the example above, the <gi>bTrem</gi> element itself does not have a duration.
          Instead, this duration is derived from that of the child element. The <att>slash</att>
          attribute value indicates the exact note values in an aural rendition of a measured
          tremolo, i.e., 4ths or 8ths=1, 16ths=2, 32nds=3, 64ths=4, 128ths=5, 256ths=6. The stem
          modifier (z) must also be explicity set on the child <gi>note</gi> or <gi>chord</gi>
          element for a complete visual representation.</p>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <layer>
            <note/>
            <bTrem slash="3">
              <note pname="g" oct="4" dur="4" stem.mod="3slash"/>
            </bTrem>
            <note/>
          </layer>
        </egXML>

        <p>The <gi>bTrem</gi> element may also be used for wind instrument double, triple, and
          flutter tonguing. In these cases, the <att>num</att> attribute on <gi>bTrem</gi> can
          record a number to be rendered along with the tremolo.</p>
        <!-- TODO:
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <!-\- NEED EXAMPLE HERE! -\->
          <!-\- Read, p. 349, example 20-17 -\->
        </egXML>-->

        <p>In the case of alternating pitches, MEI offers the <gi>fTrem</gi> (fingered tremolo)
          element. While it mostly behaves the same as <gi>bTrem</gi>, an unmeasured tremolo
          requires exactly two child elements, either being a <gi>note</gi> or <gi>chord</gi>. As
          with <gi>bTrem</gi>, the <att>slash</att> attribute records the number of slashes required
          – 4ths or 8ths=1, 16ths=2, 32nds=3, 64ths=4, 128ths=5, 256ths=6.</p>
        <!-- Naive encoder captures as beam! -->
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <layer>
            <note/>
            <fTrem slash="3">
              <note pname="g" oct="4" dur="4"/>
              <note pname="c" oct="4" dur="4"/>
            </fTrem>
            <note/>
          </layer>
        </egXML>

      </div>

      <div type="div4" xml:id="cmnFermata">
        <head>Fermata</head>
        <p> A very common feature of music notation from the CMN period is the so-called
            <soCalled>fermata</soCalled>. It is usually written as semicircle with a dot in the
          middle, and it stands above or sometimes below the staff it affects. If this symbol is
          used, its <soCalled>open</soCalled> side always directs to the staff. A fermata indicates
          that the note or rest under it should be held longer than its written duration would
          normally require. Sometimes, a fermata occurs over a barline to indicate the end of a
          phrase or section. </p>
        <p> In MEI, fermatas may be encoded as attribute on <gi>note</gi>, <gi>chord</gi> or
            <gi>rest</gi>. This attribute allows to place a fermata above or below the element to
          which it's attached. </p>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <note fermata="above"/>
        </egXML>
        <p> However, if there is further information about the fermata that should be addressed in
          the encoding, MEI offers the <gi>fermata</gi> element. This element, which is a member of
          the <ident type="class">model.controleventLike</ident> class and therefore requires the
          use of such attributes as <att>staff</att>, <att>layer</att>, <att>tstamp</att> or
            <att>startid</att>, allows to specify the direction of the fermata using the
            <att>form</att> attribute. </p>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <fermata staff="2" tstamp="4" form="upright" place="above"/>
        </egXML>
        <p>The <att>shape</att> attribute may be used to indicate whether the fermata is rendered as
          a semicircle ("curved") or semisquare ("square"). If the fermata is rendered with a completely
          different symbol, this may be specified using the <att>altsym</att> attribute. </p>

      </div>

      <!-- TODO: PR will editi this! -->
      <!-- <div type="div4" xml:id="cmnOctave">
        <head>Octave shift</head>
        <p>
          <gi>octave</gi>: An indication that a passage should be performed one or more octaves above or below its written 
          pitch. The dis and dis.place attributes record the amount and direction of displacement, respectively. The rend 
          attribute captures the appearance of the continuation line associated with the octave displacement. The starting 
          point of the octave displacement may be indicated by either a tstamp, tstamp.ges, tstamp.real or startid attribute, 
          while the ending point may be recorded by either a dur, dur.ges or endid attribute. It is a semantic error not to 
          specify one starting and one ending type of attribute. Please note that the dur attribute here is not a true duration, 
          but rather a time stamp for the end point of the octave displacement. Also, note that the dur attribute is not 
          required because the octave displacement can be visually instantaneous. 
       </p>
      </div>-->

    </div>

    <div type="div3" xml:id="cmnInstr">
      <head>Instrument-specific Symbols in CMN</head>
      <p>CMN contains a number of symbols which are closely related to a specific instrument. MEI
        offers elements for three of these symbols, namely breath marks, harp pedal diagrams, and
        indications for piano pedals.</p>
      <div type="div4" xml:id="cmnBreath">
        <head>Breath Marks</head>
        <p>A <term>breath mark</term> indicates a point at which the performer of a wind instrument
          or singer may breathe. It is sometimes also used to indicate a short pause or break for
          instruments <hi rend="italic">not</hi> requiring breath, which allows it to also serve as
          a guide to phrasing. In MEI, breath marks are encoded using the <gi>breath</gi> element,
          which is a member of <ident type="class">model.controleventLike</ident>. It is a semantic
          error not to specify a starting point attribute.</p>
        <!-- TODO: Add schematron rule enforcing tstamp or startid on breath. -->
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <measure>
            <staff n="1">
              <layer>
                <note pname="g" oct="3" dur="2" syl="Wald,"/>
                <note pname="c" oct="3" dur="4" syl="so"/>
              </layer>
            </staff>
            <breath staff="1" tstamp="1.5"/>
          </measure>
        </egXML>

        <p>The usual sign for the breath mark is a comma; however, other visual forms of the breath
          mark may be indicated using the <att>altsym</att> attribute (see chapter <ptr
            target="#userSymbols"/> for further details).</p>
      </div>
      <div type="div4" xml:id="cmnHarp">
        <head>Harp Pedals</head>
        <p>Modern harps have seven pedals which allow adjustment of their strings to different
          pitches. The settings for these pedals occur at the beginning of the harp notation and/or
          whenever it is necessary to change the harp's tuning. These settings may be rendered using
          letter pitches (in the order of the pedals from left to right) or in a diagram invented by
          Carlos Salzedo.</p>
        <p>In MEI, harp pedal settings are encoded using the <gi>harpPedal</gi> element. It is a
          member of the <ident type="class">model.controleventLike</ident> class and is therefore
          placed within <gi>measure</gi>, following all <gi>staff</gi> children. The
            <att>staff</att> and <att>layer</att> attributes may be used to assign it to a certain
            <gi>staff</gi> or <gi>layer</gi>. Either a <att>tstamp</att> or <att>startid</att>
          attribute must be used to indicate the placement within the measure (see <ptr
            target="#cmnTstamp"/> and <ptr target="#ptrRef"/> for further details about those
          linking mechanisms).</p>
        <p>The musical intention of the element is described using the <att>c</att>, <att>d</att>,
            <att>e</att>, <att>f</att>, <att>g</att>, <att>a</att> and <att>b</att> attributes,
          which affect the corresponding strings of the harp. All of these attributes may take the
          values "<emph>f</emph>" (flat), "<emph>s</emph>" (sharp) or "<emph>n</emph>" (natural),
          where "n" is the default value, which is assumed when one of these attributes is not
          specified.</p>
        <!-- Add image! -->
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <measure>
            <!-- staves omitted -->
            <harpPedal staff="2" tstamp="1" b="f" e="f" a="f"/>
          </measure>
        </egXML>

      </div>
      <div type="div4" xml:id="cmnPedal">
        <head>Piano Pedal</head>
        <p>Music for piano also often includes indications of the use of pedals. In MEI, these
          symbols are encoded using the <gi>pedal</gi> element. As a member of the <ident
            type="class">model.controleventLike</ident> class, it is located within <gi>measure</gi>
          and refers to a staff, layer and timestamp using the <att>staff</att>, <att>layer</att>
          and <att>tstamp</att> attributes. Alternatively, the <att>startid</att> attribute may be
          used to identify a <gi>note</gi> or <gi>chord</gi> to which the mark should be
          assigned.</p>
        <p>The meaning of the mark is captured using the <att>dir</att> attribute, which provides
          the following values:</p>
        <list type="gloss">
          <label>up</label>
          <item>depress the pedal</item>
          <label>down</label>
          <item>release the pedal</item>
          <label>bounce</label>
          <item>depress, then immediately release the pedal</item>
          <label>half</label>
          <item>half pedal</item>
        </list>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <measure>
            <!-- staves omitted -->
            <pedal staff="2" tstamp="1" dir="down"/>
          </measure>
        </egXML>
      </div>

      <!--<div type="div4" xml:id="cmnOtherArtic">
        <!-\- TODO: Organ pedal marks? With artic.-\->
      </div>-->
    </div>

    <div type="div3" xml:id="cmnOssia">
      <head>Ossia</head>
      <p>The term <term>ossia</term>, Italian for "or", denotes an alternative for a certain passage
        which is provided by the composer <emph>without any preference</emph> of one alternative
        over another. An ossia usually describes a simpler, easier to perform version of the
        original content. Another frequent use case for ossia is the provision of indications about
        performance practice, such as an alternative version with ornamentation written out in full.
        In all cases, it is up to the performer to choose between the alternatives.</p>
      <!-- TODO: Mention <choice> here as a set of alternatives provided by an editor? Address this in the editTrans chapter. -->
      <p>Most often an ossia is rendered above the main staff on a reduced-size staff. Sometimes,
        however, the alternate material occurs on the same staff as the primary text, but in a
        separate layer. In this case, the alternative material is usually rendered in small-sized
        notation on the normal-sized staff. For both situations, MEI offers the <gi>ossia</gi>
        element, which may be nested either inside <gi>measure</gi> to reflect an ossia on a
        separate staff, or inside <gi>staff</gi> to reflect an inline ossia in a separate layer. The
        following example demonstrates an ossia on a separate staff:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <measure>
          <staff n="1">
            <!-- first staff, without ossia -->
          </staff>
          <ossia>
            <staff>
              <!-- alternative content on reduced-size staff -->
            </staff>
            <staff n="2">
              <!-- original content on regular staff -->
            </staff>
          </ossia>
          <staff n="3">
            <!-- third staff, without ossia -->
          </staff>
        </measure>
      </egXML>

      <p>The example above demonstrates that only one of the two <gi>staff</gi>s in <gi>ossia</gi>
        has an <att>n</att> attribute. This mechanism allows one to distinguish between the
        "regular" and the alternative content: The one bearing the <att>n</att> attribute goes in
        line with the preceding measure's staff, the other one is printed in reduced size above. In
        this case, the vertical order of staves follows document order: The top-most staff is
        encoded as the first child, the lowest comes last. In combination with the presence of the
          <att>n</att> attribute, this allows the capture of multiple simultaneous ossia staves.</p>
      <p>All staves within <gi>ossia</gi>, even the alternative ones without a direct reference,
        obey the definitions of the associated <gi>staffDef</gi>, which can be derived from the
        value of the <att>n</att> attribute. Alternatively, a separate <gi>staffDef</gi> may be
        given at the beginning of the contained <gi>layer</gi> element(s).</p>
      <p>In case of an inline ossia, the whole setup of elements moves down one step in the
        hierarchy, as seen in the following example:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <measure>
          <staff n="1">
            <!-- content omitted -->
          </staff>
          <staff n="2">
            <ossia>
              <layer n="1">
                <!-- original content in regular layer -->
              </layer>
              <layer>
                <!-- alternative content in separate layer -->
              </layer>
            </ossia>
          </staff>
          <staff n="3">
            <!-- content omitted -->
          </staff>
        </measure>
      </egXML>

      <!-- TODO: There's also the "naive encoder" version of ossia (where all staves are the same, 
        only the number of them changes). Or not, depending on whether the maximum number of staves
      is recorded or only the number of "active" ones. -->

    </div>

    <div type="div3" xml:id="cmnDir">
      <head>Directions and Rehearsal marks</head>
      <p>In CMN scores, there are often very many natural language instructions. Some of them
        concern the loudness and the speed of the performance, in which case MEI offers the elements
          <gi>dynam</gi> (described at <ptr target="#cmnDynam"/>) and <gi>tempo</gi>. In other
        cases, however, they provide other instructions for the performer. Instead of providing
        separate elements for all possible types of such directions, MEI offers the generic
          <gi>dir</gi> element. Although this element is not CMN specific (it is defined in <ptr
          target="#shared"/>), it is especially important in this repertoire.</p>
      <p>A tempo or character indication is often provided above the topmost staff of the first
        measure of a score, movement , or section. This indication, such as "Allegro moderato" or
        "Andante maestoso", is normally regarded as a label. Though the movement may be labelled
        using the <att>label</att> attribute on the enclosing entity (such as, <gi>mdiv</gi> or
          <gi>section</gi>), it is often required to capture the exact position, spelling, or other
        features of the label as found in the underlying source material. In these cases, an element
        is necessary.</p>
      <p>Since these labels often address the tempo at which the music should be performed, these
        labels should be encoded using the <gi>tempo</gi> element, which is a specialized form of
          <gi>dir</gi>. <gi>tempo</gi> is a member of the <ident type="class"
          >model.controleventLike</ident> class and as such occurs as a child of <gi>measure</gi>,
        following all <gi>staff</gi> children. Its <att>staff</att>, <att>layer</att> and
          <att>tstamp</att> attributes are used to ensure correct semantic positioning, and
          <att>place</att> indicates a visual position with respect to the staff.</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <measure n="1">
          <!-- all staves omitted -->
          <tempo staff="1" tstamp="1" place="above">Allegro moderato</tempo>
        </measure>
      </egXML>

      <p><term>Rehearsal marks</term> are another specialized kind of directive. These marks,
        consisting of letters, numbers, or a combination of both, are used in scores and
        corresponding performer parts to identify convenient points to restart rehearsal after
        breaks or interruptions. For this reason, they are often visually emphasized by placing them
        within a surrounding square or circle. In MEI, they are encoded using the <gi>reh</gi>
        element, which holds the textual content of the rehearsal mark. The visual rendition of the
        rehearsal mark may be captured using the <gi>rend</gi> element described in chapter <ptr
          target="#textRendition"/>.</p>
      <p>The following detail from an edition of Hector Berlioz' <title>Symphonie
          Fantastique</title> shows a typical example:</p>
      <figure>
        <graphic url="Images/modules/cmn/reh_berlioz.png" width="185px"/>
      </figure>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <measure>
          <staff n="1">
            <!-- content omitted -->
          </staff>
          <staff n="2">
            <!-- content omitted -->
          </staff>
          <staff n="3">
            <!-- content omitted -->
          </staff>
          <reh staff="1" place="above" tstamp="1">
            <rend rend="box">37</rend>
          </reh>
        </measure>
      </egXML>

      <p>The following example demonstrates how rehearsal marks often apply to more than one
        staff:</p>
      <egXML xmlns="http://www.tei-c.org/ns/Examples">
        <measure>
          <reh staff="1" place="above" tstamp="1">A</reh>
          <reh staff="7 11" place="within" tstamp="1">A</reh>
          <reh staff="16" place="below" tstamp="1">A</reh>
        </measure>
      </egXML>

    </div>

    <div type="div3" xml:id="cmnRep">
      <head>Repetition in CMN</head>
      <p>A characteristic feature of music is repetition. Many musical forms rely on repetition
        (sometimes with modification) of distinct sections of the music. Repetition in this sense
        can be thought of as <soCalled>structural</soCalled>. At the same time, composers and
        engravers of music often use local symbols for repeating smaller portions of music instead
        of writing them in full more than once. In this case, the repetition is better defined as a
        species of abbreviation.</p>
      <div type="div4" xml:id="cmnRepStruct">
        <head>Structural Repetition</head>
        <p>Large-scale structural repetition, utilizing <gi>section</gi> and <gi>expansion</gi>
          elements, is discussed in section <ptr target="#mdivContent"/>. This section will focus on
          repetition within sections.
          <!-- TODO: What needs to be handled here:            
            section and ending details 
            measure/@right="rptstart" etc.
          -->
        </p>
      </div>
      <div type="div4" xml:id="cmnRepSym">
        <head>Measure-Level Repetition Symbols</head>
        <p>In addition to repetition at the section level, CMN includes a number of different
          symbols for measure-level repetitions. Many of these symbols are found in manuscripts and
          may be regarded as personal conventions of their respective authors. Some signs, however,
          have been widely adopted. For example, it is common to indicate the repetition of a single
          beat or an entire measure with one or more diagonal lines, sometimes with dots at the
          upper left and lower right, much like a percent sign. The illustration below contains the
          most common signs:</p>
        <figure>
          <head>Beat repeat signs</head>
          <graphic url="Images/ExampleImages/beatrpt-20100510.png" height="400px"/>
        </figure>
        <p>In general, MEI places primary emphasis on the capture of the semantic meaning of
          symbols, not their visual rendition. In this case, the focus is on the material being
          repeated, for example, a beat, a measure, a 2-measure fragment, etc. The following
          elements are provided for this purpose:</p>
        <p>
          <specList>
            <specDesc key="beatRpt"/>
            <specDesc key="halfmRpt"/>
            <specDesc key="mRpt"/>
            <specDesc key="mRpt2"/>
            <specDesc key="multiRpt"/>
          </specList>
        </p>

        <p>The <gi>beatRpt</gi> element is used to represent a single repeated beat. Its visual
          rendition can be recorded using the <att>rend</att> attribute. This attribute indicates
          the number of slashes required to render the appropriate repeat symbol, which, as
          demonstrated in the preceding figure, depends on the rhythmic content of the beat being
          repeated. When a beat that consists of a single note or chord is repeated, the repetition
          sign is typically rendered as a single thick, slanting slash; therefore, the value '1'
          should be used. The following values should be used when the beat is divided into even
          notes: 4ths or 8ths=1, 16ths=2, 32nds=3, 64ths=4, 128ths=5. When the beat is comprised of
          mixed duration values, the symbol is always rendered as 2 slashes and 2 dots.</p>
        <p>In addition to its indication of a repeated beat, the beatRpt element is sometimes used
          in popular music notation, especially in guitar or percussion parts, to indicate a
          repeated rhythmic pattern. The <gi>beatRpt</gi> element can be used, but when these parts
          require durations longer or shorter than a beat, note elements with appropriately-shaped
          note heads should be employed instead.</p>
        <!-- TODO:
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <!-\- NEED EXAMPLE HERE! -\->
        </egXML>-->

        <p>The <gi>mRpt</gi> element is available for repetition of an entire measure. Like
            <gi>mRest</gi>, it must be the sole child of <gi>layer</gi>, no other events may be
          used. The <att>n</att> attribute of <gi>mRpt</gi> should not be used to record the number
          displayed above the measure in the figure below. Instead, the numbering of repetitions of
          the written-out measure can be enabled using the <att>multi.number</att> attribute
          available on the <gi>scoreDef</gi> and <gi>staffDef</gi> elements.</p>
        <figure>
          <head>Measure repetition</head>
          <graphic url="Images/ExampleImages/mrpt-20100510.png" height="100px"/>
        </figure>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <measure>
            <staff>
              <layer>
                <beam>
                  <note pname="f" oct="4" dur="8"/>
                  <note pname="a" dur="16"/>
                  <note pname="c" oct="5"/>
                  <note pname="a" oct="4" dur="8"/>
                </beam>
                <beam>
                  <note pname="c" oct="5" dur="8"/>
                  <note pname="a" oct="4"/>
                  <note pname="g"/>
                </beam>
              </layer>
            </staff>
          </measure>
          <measure>
            <staff>
              <layer>
                <mRpt/>
              </layer>
            </staff>
          </measure>
          <measure>
            <staff>
              <layer>
                <mRpt/>
              </layer>
            </staff>
          </measure>
          <measure>
            <staff>
              <layer>
                <mRpt/>
              </layer>
            </staff>
          </measure>
        </egXML>

        <!-- TODO: Re: the halfmRpt, I have a kind of bad feeling. It seems arbitrary to have that, instead of a generic
          rptSnippet or so. I know that you invented it for my Waldstein example (or was it one of the others?), but it seems
          wrong. I'd prefer to specify the snippet to be repeated by a tstamp and dur combination, maybe also with a reference 
          to a measure in there. That would definitely be much more helpful than halfmRpt. Should we put this on the table and
          offer to deprecate halfmRpt? I know we have to keep it for now, but…
        -->

        <p>The <gi>halfmRpt</gi> element represents the incorrect, but frequently found, use of the
          measure repeat sign (or similar sign) to indicate repetition of half of a measure. This
          practice mostly occurs in hand-written notation and usually involves the repetition of the
          second half of a measure in duple time. This element is necessary because the function of
          the symbol, not the visual symbol itself, is of primary importance. The following example
          from the beginning of Beethoven's <title>Waldstein</title> sonata illustrates such
          usage:</p>
        <figure>
          <graphic url="Images/modules/cmn/halfmRpt_beethoven.png" width="418px"/>
        </figure>
        <egXML xmlns="http://www.tei-c.org/ns/Examples">
          <measure>
            <staff n="1"><!-- omitted --></staff>
            <staff n="2">
              <layer n="1"><!-- omitted --></layer>
              <layer n="2">
                <chord dur="2" stem.mod="1slash">
                  <note pname="g" oct="2"/>
                  <note pname="b" oct="1"/>
                </chord>
                <halfmRpt/>
              </layer>
            </staff>
          </measure>
          <measure>
            <staff n="1"><!-- omitted --></staff>
            <staff n="2">
              <layer n="2">
                <halfmRpt/>
                <halfmRpt/>
              </layer>
            </staff>
          </measure>
        </egXML>

        <p>As seen in the example above, it is possible to continuously repeat half measures, even
          across barlines.</p>
        <p>The <gi>mRpt2</gi> and <gi>multiRpt</gi> elements (as well as the <gi>multRest</gi>
          element) never occur in scores, only in performer parts, where it is often necessary to
          abbreviate the notation due to page size limitations.</p>
        <figure>
          <head>Two-measure repetition</head>
          <graphic url="Images/ExampleImages/mrpt2-20100510.png" height="200px"/>
        </figure>
        <figure>
          <head>Multi-measure repetition</head>
          <graphic url="Images/ExampleImages/multirpt-20100510.png" height="100px"/>
        </figure>

        <p>The <gi>mRpt2</gi> element represents repetition of a 2-measure fragment, while
            <gi>multiRpt</gi> is for repetition of fragments longer than two measures. In modern
          publishing practice, repeats of more than two measures are written out using repeat signs.
          This element is provided, however, for handling non-standard practices often found in
          manuscripts. The <att>num</att> attribute on <gi>multiRpt</gi> records the number of
          preceding measures to be repeated.</p>
        <p>All elements described in the following allow for the capture of the original symbol by
          using either the <att>facs</att> or <att>altsym</att> attribute, however. See <ptr
            target="#facsimile"/> and <ptr target="#userSymbols"/> for further details. On all these
          elements the <att>expand</att> attribute may be used to indicate whether to render the
          repeat symbol ("false"), or the repeated content ("true").</p>
      </div>
    </div>
  </div>
  <!--<div type="div2" xml:id="originalContent">
    <head>Overview of the CMN Module</head>
    <p>The module described in this chapter makes available the following components:</p>
    <!-\-<div type="div3" xml:id="cmnElements">
      <head>Elements</head>
      <p>
        <specList>
          <specDesc key="_arpeg"/>
          <specDesc key="_beam"/>
          <specDesc key="_beamSpan"/>
          <specDesc key="_beatRpt"/>
          <specDesc key="_bend"/>
          <specDesc key="_breath"/>
          <specDesc key="_bTrem"/>
          <specDesc key="_fermata"/>
          <specDesc key="_fTrem"/>
          <specDesc key="_hairpin"/>
          <specDesc key="_harpPedal"/>
          <specDesc key="_gliss"/>
          <specDesc key="_halfmRpt"/>
          <specDesc key="_measure"/>
          <specDesc key="_mRest"/>
          <specDesc key="_mRpt"/>
          <specDesc key="_mRpt2"/>
          <specDesc key="_mSpace"/>
          <specDesc key="_multiRest"/>
          <specDesc key="_multiRpt"/>
          <specDesc key="_octave"/>
          <specDesc key="_ossia"/>
          <specDesc key="_pedal"/>
          <specDesc key="_reh"/>
          <specDesc key="_slur"/>
          <specDesc key="_tie"/>
          <specDesc key="_tuplet"/>
          <specDesc key="_tupletSpan"/>
        </specList>
     </p>
    </div>-\->
    <div type="div3" xml:id="cmnAttributeClasses">
      <head>Attribute Classes</head>
      <p>
        <specList>
          <specDesc key="att.arpeg.anl"/>
          <specDesc key="att.arpeg.ges"/>
          <specDesc key="att.arpeg.log"/>
          <specDesc key="att.arpeg.vis"/>
          <specDesc key="att.beam.anl"/>
          <specDesc key="att.beam.ges"/>
          <specDesc key="att.beam.log"/>
          <specDesc key="att.beam.vis"/>
          <specDesc key="att.beamed"/>
          <specDesc key="att.beamedwith"/>
          <specDesc key="att.beaming.log"/>
          <specDesc key="att.beamrend"/>
          <specDesc key="att.beamsecondary"/>
          <specDesc key="att.beamSpan.anl"/>
          <specDesc key="att.beamSpan.ges"/>
          <specDesc key="att.beamSpan.log"/>
          <specDesc key="att.beamSpan.vis"/>
          <specDesc key="att.beatRpt.anl"/>
          <specDesc key="att.beatRpt.ges"/>
          <specDesc key="att.beatRpt.log"/>
          <specDesc key="att.beatRpt.vis"/>
          <specDesc key="att.bend.anl"/>
          <specDesc key="att.bend.ges"/>
          <specDesc key="att.bend.log"/>
          <specDesc key="att.bend.vis"/>
          <specDesc key="att.breath.anl"/>
          <specDesc key="att.breath.ges"/>
          <specDesc key="att.breath.log"/>
          <specDesc key="att.breath.vis"/>
          <specDesc key="att.bTrem.anl"/>
          <specDesc key="att.bTrem.ges"/>
          <specDesc key="att.bTrem.log"/>
          <specDesc key="att.bTrem.vis"/>
          <specDesc key="att.chord.ges.cmn"/>
          <specDesc key="att.chord.log.cmn"/>
          <specDesc key="att.chord.vis.cmn"/>
          <specDesc key="att.cutout"/>
          <specDesc key="att.expandable"/>
          <specDesc key="att.fermata.anl"/>
          <specDesc key="att.fermata.ges"/>
          <specDesc key="att.fermata.log"/>
          <specDesc key="att.fermata.vis"/>
          <specDesc key="att.fTrem.anl"/>
          <specDesc key="att.fTrem.ges"/>
          <specDesc key="att.fTrem.log"/>
          <specDesc key="att.fTrem.vis"/>
          <specDesc key="att.gliss.anl"/>
          <specDesc key="att.gliss.ges"/>
          <specDesc key="att.gliss.log"/>
          <specDesc key="att.gliss.vis"/>
          <specDesc key="att.graced"/>
          <specDesc key="att.hairpin.anl"/>
          <specDesc key="att.hairpin.ges"/>
          <specDesc key="att.hairpin.log"/>
          <specDesc key="att.hairpin.vis"/>
          <specDesc key="att.halfmRpt.anl"/>
          <specDesc key="att.halfmRpt.ges"/>
          <specDesc key="att.halfmRpt.log"/>
          <specDesc key="att.halfmRpt.vis"/>
          <specDesc key="att.harpPedal.anl"/>
          <specDesc key="att.harpPedal.ges"/>
          <specDesc key="att.harpPedal.log"/>
          <specDesc key="att.harpPedal.vis"/>
          <specDesc key="att.layerDef.log.cmn"/>
          <specDesc key="att.lvpresent"/>
          <specDesc key="att.measure.vis"/>
          <specDesc key="att.mRest.anl"/>
          <specDesc key="att.mRest.ges"/>
          <specDesc key="att.mRest.log"/>
          <specDesc key="att.mRest.vis"/>
          <specDesc key="att.mRpt.anl"/>
          <specDesc key="att.mRpt.ges"/>
          <specDesc key="att.mRpt.log"/>
          <specDesc key="att.mRpt.vis"/>
          <specDesc key="att.mRpt2.anl"/>
          <specDesc key="att.mRpt2.ges"/>
          <specDesc key="att.mRpt2.log"/>
          <specDesc key="att.mRpt2.vis"/>
          <specDesc key="att.mSpace.anl"/>
          <specDesc key="att.mSpace.ges"/>
          <specDesc key="att.mSpace.log"/>
          <specDesc key="att.mSpace.vis"/>
          <specDesc key="att.multiRest.anl"/>
          <specDesc key="att.multiRest.ges"/>
          <specDesc key="att.multiRest.log"/>
          <specDesc key="att.multiRest.vis"/>
          <specDesc key="att.multiRpt.anl"/>
          <specDesc key="att.multiRpt.ges"/>
          <specDesc key="att.multiRpt.log"/>
          <specDesc key="att.multiRpt.vis"/>
          <specDesc key="att.note.ges.cmn"/>
          <specDesc key="att.note.log.cmn"/>
          <specDesc key="att.note.vis.cmn"/>
          <specDesc key="att.numbered"/>
          <specDesc key="att.numberplacement"/>
          <specDesc key="att.octave.anl"/>
          <specDesc key="att.octave.ges"/>
          <specDesc key="att.octave.log"/>
          <specDesc key="att.octave.vis"/>
          <specDesc key="att.ornamentaccid"/>
          <specDesc key="att.ossia.anl"/>
          <specDesc key="att.ossia.ges"/>
          <specDesc key="att.ossia.log"/>
          <specDesc key="att.ossia.vis"/>
          <specDesc key="att.pedal.anl"/>
          <specDesc key="att.pedal.ges"/>
          <specDesc key="att.pedal.log"/>
          <specDesc key="att.pedal.vis"/>
          <specDesc key="att.phrase.vis.cmn"/>
          <specDesc key="att.pianopedals"/>
          <specDesc key="att.reh.anl"/>
          <specDesc key="att.reh.ges"/>
          <specDesc key="att.reh.log"/>
          <specDesc key="att.reh.vis"/>
          <specDesc key="att.rehearsal"/>
          <specDesc key="att.rest.log.cmn"/>
          <specDesc key="att.rest.vis.cmn"/>
          <specDesc key="att.scoreDef.log.cmn"/>
          <specDesc key="att.scoreDef.vis.cmn"/>
          <specDesc key="att.slur.anl"/>
          <specDesc key="att.slur.ges"/>
          <specDesc key="att.slur.log"/>
          <specDesc key="att.slur.vis"/>
          <specDesc key="att.slurrend"/>
          <specDesc key="att.space.log.cmn"/>
          <specDesc key="att.staffDef.log.cmn"/>
          <specDesc key="att.staffDef.vis.cmn"/>
          <specDesc key="att.stemmed.cmn"/>
          <specDesc key="att.tie.anl"/>
          <specDesc key="att.tie.ges"/>
          <specDesc key="att.tie.log"/>
          <specDesc key="att.tie.vis"/>
          <specDesc key="att.tierend"/>
          <specDesc key="att.tuplet.anl"/>
          <specDesc key="att.tuplet.ges"/>
          <specDesc key="att.tuplet.log"/>
          <specDesc key="att.tuplet.vis"/>
          <specDesc key="att.tupletSpan.anl"/>
          <specDesc key="att.tupletSpan.ges"/>
          <specDesc key="att.tupletSpan.log"/>
          <specDesc key="att.tupletSpan.vis"/>
        </specList>
     </p>
    </div>
    <div type="div3" xml:id="cmnModelClasses">
      <head>Model Classes</head>
      <p>
        <specList>
          <specDesc key="model.controleventLike.cmn"/>
          <specDesc key="model.eventLike.cmn"/>
          <specDesc key="model.eventLike.measureFilling"/>
          <specDesc key="model.layerPart.cmn"/>
          <specDesc key="model.measureLike"/>
          <specDesc key="model.measurePart"/>
          <specDesc key="model.ossiaLike"/>
          <specDesc key="model.sectionPart.cmn"/>
        </specList>
     </p>
    </div>
  </div>-->
</div>
